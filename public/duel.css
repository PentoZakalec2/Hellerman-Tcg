/* --- duel.css - FINAL MASTER DUEL UI --- */

/* 1. RESET */
* { box-sizing: border-box; }

body {
    margin: 0; background: #080808;
    background-image: radial-gradient(circle at 50% 50%, #1a1a20 0%, #000 100%);
    color: white; font-family: 'Rajdhani', sans-serif;
    height: 100vh; width: 100vw; overflow: hidden; user-select: none;
}

.duel-wrapper { display: flex; width: 100%; height: 100%; }

/* --- PANELE BOCZNE --- */
.side-panel {
    display: flex; flex-direction: column; padding: 20px; z-index: 100;
    background: rgba(12, 12, 16, 0.95); backdrop-filter: blur(5px);
}
.side-panel.left {
    width: 280px; border-right: 1px solid #333;
    justify-content: flex-start; padding-top: 30px; gap: 20px; flex-shrink: 0;
}
.side-panel.right {
    width: 200px; border-left: 1px solid #333;
    justify-content: flex-start; padding-top: 50px; gap: 20px; flex-shrink: 0;
}

/* --- ŚRODEK (PLANSZA) --- */
.board-container {
    flex-grow: 1; position: relative;
    display: flex; flex-direction: column; justify-content: center; align-items: center;
}

.player-zone { width: 100%; display: flex; flex-direction: column; align-items: center; position: relative; }

.center-divider {
    width: 95%; height: 2px;
    background: linear-gradient(90deg, transparent, rgba(0, 255, 255, 0.5), transparent);
    margin: 10px 0; box-shadow: 0 0 15px cyan;
}

/* --- PLAYMAT --- */
.field-half {
    display: flex; gap: 15px; padding: 20px 40px;
    background: rgba(255, 255, 255, 0.02);
    border: 1px solid rgba(255, 255, 255, 0.05); border-radius: 8px;
}

/* PRZECIWNIK (GÓRA) - NAPRAWIONY UKŁAD */
.field-half.top {
    flex-direction: row; align-items: flex-end; margin-bottom: 20px;
    /* Usunięto column-reverse, teraz HTML decyduje o kolejności */
}

/* TY (DÓŁ) */
.field-half.bottom {
    flex-direction: row; align-items: flex-start; margin-top: 20px;
    margin-bottom: 120px; /* Miejsce na rękę */
}

.grid-area { display: flex; flex-direction: column; gap: 15px; }
.row { display: flex; gap: 15px; }

/* Sloty */
.slot, .side-slot {
    width: 85px; height: 120px; background: rgba(0, 0, 0, 0.4);
    border: 2px solid #333; border-radius: 6px;
    display: flex; justify-content: center; align-items: center; transition: 0.2s; position: relative;
}
.slot.zone-m:hover { border-color: #00d2ff; box-shadow: 0 0 15px rgba(0, 210, 255, 0.3); cursor: pointer; }

.deck-slot { background-image: url('card_back.png'); background-size: cover; }
.gy-slot { background-image: url('graveyard_icon.png'); background-size: 50%; background-repeat: no-repeat; background-position: center; border-style: dashed; }
#deck-count { position: absolute; bottom: -20px; width: 100%; text-align: center; font-size: 12px; color: #888; }

/* Karty */
.field-card { width: 100%; height: 100%; border-radius: 4px; object-fit: cover; }
.field-card.def { transform: rotate(90deg); border: 2px solid #3498db; }
.gy-card { width: 100%; height: 100%; border-radius: 4px; filter: grayscale(1); }

/* Statystyki */
.card-stats-overlay {
    position: absolute; bottom: 0; left: 0; width: 100%;
    display: flex; justify-content: space-between; padding: 2px 5px;
    background: rgba(0, 0, 0, 0.9); border-top: 1px solid #555;
    font-size: 11px; font-weight: 800; z-index: 5;
}
.stat-val.atk { color: #e74c3c; } .stat-val.def { color: #3498db; }
.on-card-level { position: absolute; top: -8px; right: -8px; background: #000; border: 1px solid gold; border-radius: 50%; width: 22px; height: 22px; display: flex; justify-content: center; align-items: center; font-size: 11px; color: gold; z-index: 10; box-shadow: 0 2px 5px black; }
.type-icon { position: absolute; top: -8px; left: -8px; width: 22px; height: 22px; background: #000; border: 1px solid white; border-radius: 50%; display: flex; justify-content: center; align-items: center; font-size: 12px; z-index: 10; }

/* --- HUD (ROGOWY) --- */
.hud-top, .hud-bottom {
    position: absolute; display: flex; align-items: center; gap: 15px;
    padding: 10px; width: 300px; z-index: 400;
    background: linear-gradient(90deg, rgba(0,0,0,0.9), transparent); border-left: 4px solid gold;
}
.hud-top { top: 20px; left: 20px; }
.hud-bottom { bottom: 20px; left: 20px; }

.avatar { width: 65px; height: 65px; border-radius: 50%; border: 2px solid gold; background: #222 url('profile_icon.png') center/cover; box-shadow: 0 0 15px gold; transition: 0.2s; }
.avatar.opp-avatar { cursor: crosshair; } .avatar.opp-avatar:hover { border-color: red; box-shadow: 0 0 25px red; }
.hp-display { flex-grow: 1; }
.hp-nums { display: flex; justify-content: space-between; font-size: 22px; font-weight: 800; margin-bottom: 5px; text-shadow: 0 2px 4px black; }
.hp-bar-bg { width: 100%; height: 12px; background: #222; transform: skewX(-20deg); border: 1px solid #555; overflow: hidden; }
.hp-bar-fill { height: 100%; width: 100%; background: #e74c3c; transition: width 0.5s ease; }
.hp-bar-fill.me { background: #2ecc71; }

/* --- RĘKA PRZECIWNIKA (WYŚRODKOWANA NA GÓRZE) --- */
.hand-mini {
    position: absolute; 
    top: -15px; /* Lekko wystaje */
    left: 50%; 
    transform: translateX(-50%);
    display: flex; gap: 5px;
    z-index: 300;
}
.hand-mini .hand-card {
    width: 60px; height: 90px;
    border: 1px solid #777; border-radius: 4px;
    background-image: url('card_back.png'); background-size: cover;
    box-shadow: 0 5px 15px black;
}

/* --- RĘKA TWOJA (WYŚRODKOWANA NA DOLE) --- */
.hand-overlay {
    position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%);
    display: flex; align-items: flex-end; justify-content: center; gap: 8px;
    height: 160px; padding-bottom: 10px; z-index: 500; pointer-events: none;
}
.hand-card {
    width: 105px; height: 155px;
    background-size: cover; border-radius: 8px; border: 1px solid #888;
    box-shadow: 0 5px 25px rgba(0,0,0,0.8); transition: all 0.2s ease; cursor: grab;
    background-color: #111; position: relative; pointer-events: auto;
}
.hand-overlay .hand-card:hover { transform: translateY(-60px) scale(1.25); z-index: 600; border-color: white; box-shadow: 0 0 30px gold; }
.hand-card.selected { border: 3px solid gold; transform: translateY(-40px); box-shadow: 0 0 40px gold; z-index: 550; }
.level-indicator { position: absolute; top: -10px; right: -10px; width: 26px; height: 26px; background: orange; border: 2px solid white; border-radius: 50%; color: black; font-weight: 800; display: flex; justify-content: center; align-items: center; font-size: 14px; z-index: 20; box-shadow: 0 2px 5px black; }

/* /* --- OVERLAY FAZ (MASTER DUEL SLIDE-UP) --- */
.phase-bar-overlay {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(0, 0, 0, 0.6); /* Przyciemnienie tła */
    z-index: 2000;
    
    /* Animacja pojawiania się */
    opacity: 0; 
    pointer-events: none; /* Domyślnie przepuszcza kliknięcia */
    transition: opacity 0.3s ease;
    display: flex; 
    align-items: flex-end; /* Przyklej menu do dołu */
    justify-content: center;
}

/* Klasa aktywna (dodawana przez JS) */
.phase-bar-overlay.visible {
    opacity: 1;
    pointer-events: auto; /* Teraz łapie kliknięcia */
}

/* Kontener Paska (To on się wysuwa) */
.phase-track-container {
    width: 100%;
    background: linear-gradient(to top, #0a0a0e 90%, transparent 100%);
    border-top: 2px solid #444;
    padding: 40px 0 60px 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 30px;
    
    /* Animacja wysuwania */
    transform: translateY(100%); /* Schowany pod ekranem */
    transition: transform 0.4s cubic-bezier(0.2, 0.8, 0.2, 1);
    box-shadow: 0 -10px 50px rgba(0,0,0,0.8);
}

.phase-bar-overlay.visible .phase-track-container {
    transform: translateY(0); /* Wjeżdża na ekran */
}

/* Pasek z kółkami */
.phase-track {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 40px; /* Odstęp między fazami */
    position: relative;
}

/* Linia łącząca */
.phase-track::before {
    content: ''; position: absolute;
    top: 50%; left: 20px; right: 20px;
    height: 4px; background: #333;
    z-index: 0; transform: translateY(-50%);
}

/* Pojedyncze Kółko Fazy */
.phase-node {
    width: 90px; height: 90px;
    border-radius: 50%;
    background: #1a1a1d;
    border: 3px solid #555;
    color: #888;
    display: flex; justify-content: center; align-items: center;
    font-weight: 800; font-size: 14px; letter-spacing: 1px;
    text-transform: uppercase;
    position: relative; z-index: 1; /* Nad linią */
    transition: all 0.2s;
    box-shadow: 0 5px 15px black;
}

/* AKTUALNA FAZA (Świeci na złoto/żółto) */
.phase-node.current {
    border-color: #f1c40f;
    color: #fff;
    background: radial-gradient(circle, #554400, #111);
    box-shadow: 0 0 25px rgba(241, 196, 15, 0.6);
    transform: scale(1.15);
}

/* FAZA DOSTĘPNA DO KLIKNIĘCIA (Świeci na niebiesko po najechaniu) */
.phase-node.clickable {
    cursor: pointer;
    border-color: #3498db;
    color: #ddd;
}
.phase-node.clickable:hover {
    background: #203a4d;
    box-shadow: 0 0 20px #3498db;
    transform: scale(1.1);
    color: white;
}

/* FAZA NIEDOSTĘPNA */
.phase-node.disabled {
    opacity: 0.4;
    filter: grayscale(1);
    cursor: not-allowed;
}

/* Przycisk Anuluj */
.phase-cancel-btn {
    padding: 12px 60px;
    background: transparent;
    border: 2px solid #555;
    color: #aaa;
    font-weight: bold;
    font-family: 'Rajdhani', sans-serif;
    font-size: 16px;
    cursor: pointer;
    border-radius: 30px;
    transition: 0.2s;
}
.phase-cancel-btn:hover {
    border-color: white;
    color: white;
    background: rgba(255,255,255,0.1);
}

/* --- PANELE I PODGLĄD (RESZTA BEZ ZMIAN) --- */
.card-preview-box { width: 100%; background: #111; border: 3px solid #555; border-radius: 8px; padding: 12px; display: flex; flex-direction: column; gap: 10px; box-shadow: 0 0 20px black; }
.card-preview-box.rarity-common { border-color: #95a5a6; }
.card-preview-box.rarity-rare { border-color: #3498db; box-shadow: 0 0 15px rgba(52, 152, 219, 0.3); }
.card-preview-box.rarity-epic { border-color: #9b59b6; box-shadow: 0 0 20px rgba(155, 89, 182, 0.4); }
.card-preview-box.rarity-legendary { border-color: #f1c40f; box-shadow: 0 0 25px rgba(241, 196, 15, 0.5); }
.preview-header { display: flex; justify-content: space-between; font-weight: bold; border-bottom: 1px solid #333; padding-bottom: 5px; color: #fff; }
.preview-img-container { width: 100%; aspect-ratio: 2/3; overflow: hidden; border: 1px solid #333; background: black; }
#preview-image { width: 100%; height: 100%; object-fit: contain; }
.level-stars-bar { display: flex; justify-content: center; gap: 4px; min-height: 20px; }
.star-icon { color: gold; font-size: 16px; text-shadow: 0 0 5px orange; animation: popIn 0.3s; }
.preview-stats { display: flex; justify-content: space-between; background: #080808; padding: 8px; border: 1px solid #333; border-radius: 4px; }
.stat-box { display: flex; flex-direction: column; align-items: center; width: 45%; }
.stat-box .label { font-size: 10px; color: #666; font-weight: bold; letter-spacing: 1px; }
.stat-box .val { font-size: 20px; font-weight: 800; }
.stat-box.atk .val { color: #e74c3c; } .stat-box.def .val { color: #3498db; }
.preview-desc-box { background: rgba(255,255,255,0.05); padding: 10px; border: 1px solid #333; border-radius: 4px; flex-grow: 1; overflow-y: auto; max-height: 300px; }
.type-line { display: block; font-size: 12px; color: #aaa; margin-bottom: 5px; font-style: italic; border-bottom: 1px dashed #444; }
#preview-desc { font-size: 12px; color: #ddd; line-height: 1.4; margin: 0; }
.system-buttons { display: flex; gap: 15px; margin-top: auto; width: 100%; justify-content: center; padding-bottom: 10px; }
.side-btn { width: 70px; height: 70px; border-radius: 12px; background: linear-gradient(145deg, #1a1a1d, #0d0d0f); border: 2px solid rgba(255,255,255,0.1); color: #666; font-size: 32px; cursor: pointer; transition: 0.3s; display: flex; justify-content: center; align-items: center; }
.side-btn:hover { color: white; transform: translateY(-3px); }
.side-btn.surrender:hover { background: linear-gradient(145deg, #7c0a0a, #c0392b); border-color: #e74c3c; box-shadow: 0 0 25px rgba(231,76,60,0.8); }
.side-btn.draw:hover { background: linear-gradient(145deg, #7f6000, #f1c40f); border-color: #f1c40f; box-shadow: 0 0 25px rgba(241,196,15,0.8); }
.phase-control { position: relative; margin-bottom: 30px; display: flex; justify-content: center; }
.phase-btn { width: 110px; height: 110px; border-radius: 50%; background: radial-gradient(circle at 30% 30%, #3498db, #102a44); border: 4px solid #85c1e9; color: white; cursor: pointer; display: flex; flex-direction: column; justify-content: center; align-items: center; box-shadow: 0 0 30px rgba(52, 152, 219, 0.5); transition: 0.3s; }
.phase-btn:hover { transform: scale(1.05); filter: brightness(1.2); } .phase-btn.battle { background: radial-gradient(circle at 30% 30%, #e74c3c, #4a0e0e); border-color: #f1948a; box-shadow: 0 0 30px rgba(231, 76, 60, 0.5); } .phase-btn.disabled { filter: grayscale(1); cursor: not-allowed; }
.phase-label { font-size: 18px; font-weight: 900; } .phase-sub { font-size: 10px; opacity: 0.8; }
.game-log { width: 100%; height: 300px; background: rgba(0,0,0,0.5); border: 1px solid #333; padding: 10px; font-size: 12px; color: #aaa; overflow-y: auto; font-family: monospace; }
.game-log p { margin: 4px 0; border-bottom: 1px solid #222; }
.card-action-popup { position: absolute; background: rgba(20,20,25,0.95); border: 1px solid gold; border-radius: 6px; padding: 5px; display: flex; flex-direction: column; gap: 5px; z-index: 2000; box-shadow: 0 0 20px black; min-width: 120px; }
.action-opt { background: #222; color: white; border: 1px solid #444; padding: 8px 15px; cursor: pointer; font-weight: bold; }
.action-opt:hover { background: #444; border-color: white; } .action-opt.attack:hover { background: #c0392b; border-color: #e74c3c; }
.drawing-card { position: absolute; width: 90px; height: 130px; background-image: url('card_back.png'); background-size: cover; border: 1px solid white; border-radius: 5px; z-index: 1000; transition: all 0.8s ease-in-out; box-shadow: 0 0 20px gold; }
.tribute-candidate { border: 3px solid #e74c3c !important; box-shadow: 0 0 20px #e74c3c !important; cursor: pointer !important; animation: pulse 0.5s infinite alternate; }
.target-highlight { box-shadow: 0 0 30px red !important; border-color: red !important; cursor: crosshair !important; }
@keyframes pulse { from { transform: scale(1); } to { transform: scale(1.05); } }
.system-modal { position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.85); display: none; justify-content: center; align-items: center; z-index: 5000; }
.modal-box { background: #111; border: 1px solid #555; padding: 30px; border-radius: 10px; text-align: center; min-width: 300px; box-shadow: 0 0 50px black; }
.modal-btns button { margin: 10px; padding: 10px 20px; cursor: pointer; font-weight: bold; background: #333; color: white; border: 1px solid #555; }